{% extends "base.html" %}

{% block title %}AgriScan - Crop Disease Detection{% endblock %}

{% block content %}
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h2>Detect Plant Diseases Instantly</h2>
                    <p>Take a photo of a crop leaf and get instant disease detection with treatment recommendations. Works offline in the field!</p>
                </div>
            </div>
        </section>

        <section class="upload-section">
            <div class="container">
                <div class="upload-container">
                    <h3>Upload a Leaf Image</h3>
                    <div class="upload-area" id="dropArea">
                        <div class="upload-instructions">
                            <img src="{{ url_for('static', filename='images/upload-icon.svg') }}" alt="Upload Icon" id="uploadIcon">
                            <p>Drag & drop an image here or click to browse</p>
                            <input type="file" id="fileInput" accept="image/png, image/jpeg, image/jpg" hidden>
                            <button class="browse-btn" id="browseBtn">Browse Files</button>
                        </div>
                        <div class="camera-option">
                            <p>Or take a photo with your camera</p>
                            <button class="camera-btn" id="cameraBtn">
                                <img src="{{ url_for('static', filename='images/camera-icon.svg') }}" alt="Camera Icon">
                                Take Photo
                            </button>
                        </div>
                        <div class="preview-container" id="previewContainer" hidden>
                            <img id="imagePreview" alt="Image Preview">
                            <div class="preview-actions">
                                <button class="cancel-btn" id="cancelBtn">Cancel</button>
                                <button class="analyze-btn" id="analyzeBtn">Analyze</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="results-section" id="resultsSection" hidden>
            <div class="container">
                <div class="results-container">
                    <h3>Analysis Results</h3>
                    <div class="results-content">
                        <div class="results-image">
                            <img id="resultImage" alt="Analyzed Image">
                        </div>
                        <div class="results-details">
                            <div class="loader" id="resultsLoader">
                                <div class="spinner"></div>
                                <p>Analyzing image...</p>
                            </div>
                            <div id="resultsData" hidden>
                                <div class="primary-result">
                                    <h4>Primary Detection</h4>
                                    <div class="disease-name" id="primaryDiseaseName"></div>
                                    <div class="confidence" id="primaryConfidence"></div>
                                    <div class="description" id="primaryDescription"></div>
                                </div>
                                <div class="treatment-info">
                                    <h4>Treatment Recommendations</h4>
                                    <div class="treatment" id="treatmentInfo"></div>
                                    <h4>Prevention</h4>
                                    <div class="prevention" id="preventionInfo"></div>
                                </div>
                                <div class="other-possibilities">
                                    <h4>Other Possibilities</h4>
                                    <ul id="otherPossibilities"></ul>
                                </div>
                                <div class="analysis-meta">
                                    <p>Inference Time: <span id="inferenceTime"></span></p>
                                </div>
                                <button class="new-analysis-btn" id="newAnalysisBtn">Analyze Another Image</button>
                            </div>
                            <div id="errorMessage" class="error-message" hidden>
                                <p>An error occurred during analysis. Please try again.</p>
                                <button class="new-analysis-btn" id="errorRetryBtn">Try Again</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="offline-mode">
            <div class="container">
                <div class="offline-info">
                    <h3>Works Offline!</h3>
                    <p>AgriScan works even without an internet connection. Install the app on your device to use it in the field.</p>
                    <div class="offline-status" id="offlineStatusFooter">
                        <span class="status-indicator online"></span>
                        <span class="status-text">You are currently online</span>
                    </div>
                    <button class="install-btn" id="installBtnFooter" hidden>Install App</button>
                </div>
            </div>
        </section>
        
        <!-- Camera Modal -->
        <div id="cameraModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Take a Photo</h3>
                    <button id="closeCameraBtn" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <video id="cameraFeed" autoplay playsinline></video>
                    <canvas id="cameraCanvas" hidden></canvas>
                    <div class="camera-controls">
                        <button id="switchCameraBtn">
                            <img src="{{ url_for('static', filename='images/switch-camera-icon.svg') }}" alt="Switch Camera">
                        </button>
                        <button id="captureBtn">
                            <img src="{{ url_for('static', filename='images/capture-icon.svg') }}" alt="Capture">
                        </button>
                    </div>
                </div>
            </div>
        </div>
{% endblock %}

{% block scripts %}
{% endblock %}